(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5368],{7495:function(e,s,l){Promise.resolve().then(l.bind(l,1134))},5441:function(e,s,l){"use strict";l.d(s,{Z:function(){return n}});var t=l(909),a=l(151);l(3029);var r=l(6053),i=l(585);function n(e){let{images:s}=e;return(0,a.useEffect)(()=>{(0,r.D7)("30EA-8C17-6991-916C","Individual")},[]),(0,t.jsxs)("div",{children:[(!s||0===s.length)&&(0,t.jsx)("div",{className:"flex w-full items-end justify-center",children:(0,t.jsx)(i.C,{color:"gray",children:"❌ No Images Uploaded"})}),(0,t.jsx)(r.A2,{className:"container mx-auto grid grid-cols-3 gap-2",showThumbnails:!0,modalClose:"clickOutside",showControls:!1,children:null==s?void 0:s.map((e,s)=>(0,t.jsx)("img",{className:"h-full w-full rounded object-cover",src:e,alt:"Consent image ".concat(s+1)},s))},null==s?void 0:s.join(","))]})}},9644:function(e,s,l){"use strict";l.d(s,{Z:function(){return i}});var t=l(909),a=l(585),r=l(2369);function i(e){let{badgeText:s,title:l,description:i}=e;return(0,t.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center gap-4 pt-10",children:[(0,t.jsxs)("div",{className:"space-y-4 text-center",children:[(0,t.jsx)(a.C,{size:"xs",children:s}),(0,t.jsx)("h1",{className:"text-xl font-semibold tracking-tighter sm:text-lg md:text-xl",children:l}),(0,t.jsx)("p",{className:"max-w-[600px] text-sm text-muted-foreground",children:i})]}),(0,t.jsx)(r.Vt,{})]})}},1134:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return K}});var t=l(909),a=l(151),r=l(4928),i=l(2369),n=l(810),c=l(4441),o=l(585),d=l(2948),x=l(8071);function m(e){let{issue:s,onSelect:l}=e,a="high"===s.priority.toLowerCase()?"red":"medium"===s.priority.toLowerCase()?"orange":"green";return(0,t.jsxs)(x.Zb,{className:"w-full p-4 cursor-pointer",onClick:l,children:[(0,t.jsxs)(x.Ol,{className:"flex flex-col items-start justify-between p-0",children:[(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,t.jsx)(o.C,{size:"xs",children:s.issueType.charAt(0).toUpperCase()+s.issueType.slice(1)}),(0,t.jsx)(o.C,{className:"flex flex-row gap-1",size:"xs",color:a,children:s.priority.charAt(0).toUpperCase()+s.priority.slice(1)})]}),(0,t.jsxs)("div",{className:"flex flex-row gap-2 items-center justify-between w-full",children:[(0,t.jsx)(x.ll,{className:"text-md font-semibold",children:s.title}),(0,t.jsx)(o.C,{size:"sm",children:s.status})]})]}),(0,t.jsx)(x.aY,{className:"p-0",children:(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["Logged: ",(0,d.WU)(new Date(s._creationTime),"MMM d, yyyy HH:mm")]})})]})}var u=l(2737),f=l(5144),h=l(1292),p=l(2557),j=l(6907),g=l(4152);let N=g.z.object({_id:g.z.string().optional(),locationId:g.z.string().optional(),spaceId:g.z.string().optional(),facilityId:g.z.string().optional(),floor:g.z.string().optional(),buildingId:g.z.string().optional(),priority:g.z.string(),issueType:g.z.string(),assignedToId:g.z.string().optional(),title:g.z.string().min(1,"Title is required"),status:g.z.string().optional(),description:g.z.string().min(1,"Description is required"),tags:g.z.array(g.z.object({value:g.z.string(),label:g.z.string()})),followUpDate:g.z.date().optional(),files:g.z.array(g.z.object({url:g.z.string().url(),storageId:g.z.string()})).optional()});var v=l(3632),y=l(242),b=l(7338),w=l(1512);let C=e=>{let{value:s,onChange:l}=e,a=[{value:"facility",icon:(0,t.jsx)(i.BH,{}),label:"Facility"},{value:"space",icon:(0,t.jsx)(i.wn,{}),label:"Space"},{value:"general",icon:(0,t.jsx)(i.M4,{}),label:"General"}];return console.log("value",s),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-4",children:a.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>l(e.value),className:"flex flex-col items-center justify-center gap-2 rounded-lg p-4 transition-colors ".concat(s===e.value?"bg-primary text-white":"bg-white hover:bg-muted"),children:[(0,t.jsx)("div",{className:"h-5 w-5 ".concat(s===e.value?"fill-white":""),children:e.icon}),(0,t.jsx)("span",{className:"text-sm font-medium",children:e.label})]},e.value))})};var k=l(8784),I=l(6575),z=l(5900),S=l(9061),Z=l(2942);Z.fC,Z.xz;let O=Z.h_;Z.x8;let _=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(Z.aV,{ref:s,className:(0,S.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",l),...a})});_.displayName=Z.aV.displayName,a.forwardRef((e,s)=>{let{className:l,children:a,...r}=e;return(0,t.jsxs)(O,{children:[(0,t.jsx)(_,{}),(0,t.jsxs)(Z.VY,{ref:s,className:(0,S.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",l),...r,children:[a,(0,t.jsxs)(Z.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(k.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}).displayName=Z.VY.displayName,a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(Z.Dx,{ref:s,className:(0,S.cn)("text-lg font-semibold leading-none tracking-tight",l),...a})}).displayName=Z.Dx.displayName,a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(Z.dk,{ref:s,className:(0,S.cn)("text-sm text-muted-foreground",l),...a})}).displayName=Z.dk.displayName;let L=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(I.mY,{ref:s,className:(0,S.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",l),...a})});L.displayName=I.mY.displayName,a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsxs)("div",{className:"flex items-center px-3","cmdk-input-wrapper":"",children:[(0,t.jsx)(z.Z,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,t.jsx)(I.mY.Input,{ref:s,className:(0,S.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",l),...a})]})}).displayName=I.mY.Input.displayName;let T=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(I.mY.List,{ref:s,className:(0,S.cn)(" overflow-y-auto overflow-x-hidden",l),...a})});T.displayName=I.mY.List.displayName,a.forwardRef((e,s)=>(0,t.jsx)(I.mY.Empty,{ref:s,className:"py-6 text-center text-sm",...e})).displayName=I.mY.Empty.displayName;let Y=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(I.mY.Group,{ref:s,className:(0,S.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",l),...a})});Y.displayName=I.mY.Group.displayName,a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(I.mY.Separator,{ref:s,className:(0,S.cn)("-mx-1 h-px bg-border",l),...a})}).displayName=I.mY.Separator.displayName;let R=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(I.mY.Item,{ref:s,className:(0,S.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-muted data-[selected=true]:bg-none data-[selected=true]:text-accent-foreground ",l),...a})});function A(e){let{options:s,initialSelected:l=[],onChange:r,name:i,placeholder:n="Select options..."}=e,c=a.useRef(null),[d,x]=a.useState(!1),[m,u]=a.useState(l),[f,h]=a.useState(""),p=a.useCallback(e=>{u(s=>{let l=s.filter(s=>s.value!==e.value);return r(l),l})},[r]),j=a.useCallback(e=>{let s=c.current;s&&(("Delete"===e.key||"Backspace"===e.key)&&""===s.value&&u(e=>{let s=[...e];return s.pop(),r(s),s}),"Escape"===e.key&&s.blur())},[r]),g=s.filter(e=>!m.some(s=>s.value===e.value));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(L,{onKeyDown:j,className:"overflow-visible bg-transparent",children:[(0,t.jsx)("div",{className:"group rounded-md border border-input px-3 py-2 text-sm ring-offset-background focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[m.map(e=>(0,t.jsxs)(o.C,{children:[e.label,(0,t.jsx)("button",{type:"button",className:"ml-1 rounded-full outline-none ring-offset-background focus:ring-2 focus:ring-ring focus:ring-offset-2",onKeyDown:s=>{"Enter"===s.key&&p(e)},onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onClick:()=>p(e),children:(0,t.jsx)(k.Z,{className:"h-3 w-3 text-muted-foreground hover:text-foreground"})})]},e.value)),(0,t.jsx)(I.mY.Input,{ref:c,value:f,onValueChange:h,onBlur:()=>x(!1),onFocus:()=>x(!0),placeholder:n,className:"ml-2 flex-1 bg-transparent outline-none placeholder:text-muted-foreground text-base"})]})}),(0,t.jsx)("div",{className:"relative mt-2",children:(0,t.jsx)(T,{children:d&&g.length>0?(0,t.jsx)("div",{className:"absolute top-0 z-10 w-full rounded-md border bg-popover text-popover-foreground shadow-md outline-none animate-in",children:(0,t.jsx)(Y,{className:"h-full overflow-auto",children:g.map(e=>(0,t.jsx)(R,{onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onSelect:()=>{h(""),u(s=>{let l=[...s,e];return r(l),l})},className:"cursor-pointer text-base",children:e.label},e.value))})}):null})})]}),(0,t.jsx)("input",{type:"hidden",name:i,value:JSON.stringify(m.map(e=>e.value))})]})}R.displayName=I.mY.Item.displayName;var D=l(1772),M=e=>{let{selectedIssue:s}=e,{closeDrawer:l}=(0,u.Z)(),r=(0,c.Db)(n.h.tickets.upsertIssue),i=s?{...s,followUpDate:s.followUpDate?new Date(s.followUpDate):void 0}:void 0,o=(0,h.cI)({resolver:(0,p.F)(N),defaultValues:i}),d=(0,c.aM)(n.h.tickets.getAllTicketLocationsValueLabelPair),x=(0,c.aM)(n.h.spaces.getAllSpaceValueLabelPairsForUser),m=(0,c.aM)(n.h.facilities.getAllFacilityValueLabelPairs),g=(0,c.aM)(n.h.tickets.getAllTicketTypesValueLabelPair),k=(0,c.aM)(n.h.site.getAllSitesValueLabelPairs),I=(0,c.aM)(n.h.site.getFloorListValueLabelPairs,o.watch("buildingId")?{id:o.watch("buildingId")}:"skip"),[z,S]=(0,a.useState)(!1),Z=async e=>{var t,a;S(!0);let i=null!==(a=null===(t=e.files)||void 0===t?void 0:t.map(e=>e.storageId))&&void 0!==a?a:[];try{await r({...e,files:i,facilityId:e.facilityId,spaceId:e.spaceId,buildingId:e.buildingId,locationId:e.locationId,_id:null==s?void 0:s._id,followUpDate:e.followUpDate?e.followUpDate.toISOString():void 0}),S(!1),o.reset(),l()}catch(e){S(!1),console.error("Error saving issue:",e)}};return(0,t.jsx)(v.l0,{...o,children:(0,t.jsxs)("form",{onSubmit:o.handleSubmit(Z),className:"space-y-8",children:[(0,t.jsx)(v.Wi,{control:o.control,name:"issueType",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.xJ,{children:[(0,t.jsx)(v.lX,{className:"text-base",children:"Issue Type"}),(0,t.jsx)(v.NI,{children:(0,t.jsx)(C,{value:s.value,onChange:s.onChange})}),(0,t.jsx)(v.pf,{className:"text-base",children:"Select the type of issue"}),(0,t.jsx)(v.zG,{className:"text-base"})]})}}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:["facility"===o.watch("issueType")&&(0,t.jsx)(v.Wi,{control:o.control,name:"facilityId",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.xJ,{children:[(0,t.jsxs)(v.lX,{className:"text-base",children:["Facility (Optional)"," "]}),(0,t.jsxs)(y.Ph,{onValueChange:e=>{s.onChange(e),o.resetField("spaceId")},value:s.value,children:[(0,t.jsx)(v.NI,{children:(0,t.jsx)(y.i4,{children:(0,t.jsx)(y.ki,{placeholder:"Select facility"})})}),(0,t.jsx)(y.Bw,{children:null==m?void 0:m.map(e=>(0,t.jsx)(y.Ql,{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)(v.pf,{className:"text-base",children:"Select the facility where the issue is located"}),(0,t.jsx)(v.zG,{className:"text-base"})]})}}),"space"===o.watch("issueType")&&(0,t.jsx)(v.Wi,{control:o.control,name:"spaceId",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.xJ,{children:[(0,t.jsx)(v.lX,{className:"text-base",children:"Space (Optional) "}),(0,t.jsxs)(y.Ph,{onValueChange:e=>{s.onChange(e),o.resetField("facilityId")},value:s.value,children:[(0,t.jsx)(v.NI,{children:(0,t.jsx)(y.i4,{children:(0,t.jsx)(y.ki,{placeholder:"Select space"})})}),(0,t.jsx)(y.Bw,{children:null==x?void 0:x.map(e=>(0,t.jsx)(y.Ql,{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)(v.pf,{className:"text-base",children:"Select the space where the issue is located"}),(0,t.jsx)(v.zG,{className:"text-base"})]})}}),"general"===o.watch("issueType")&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Wi,{control:o.control,name:"buildingId",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.xJ,{children:[(0,t.jsx)(v.lX,{className:"text-base",children:"Building"}),(0,t.jsxs)(y.Ph,{onValueChange:s.onChange,value:s.value,children:[(0,t.jsx)(v.NI,{children:(0,t.jsx)(y.i4,{children:(0,t.jsx)(y.ki,{placeholder:"Select building"})})}),(0,t.jsx)(y.Bw,{children:null==k?void 0:k.map(e=>(0,t.jsx)(y.Ql,{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)(v.pf,{className:"text-base",children:"Select the issue location"}),(0,t.jsx)(v.zG,{className:"text-base"})]})}}),(0,t.jsx)(v.Wi,{control:o.control,name:"floor",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.xJ,{children:[(0,t.jsx)(v.lX,{className:"text-base",children:"Floor"}),(0,t.jsxs)(y.Ph,{onValueChange:s.onChange,value:s.value,children:[(0,t.jsx)(v.NI,{children:(0,t.jsx)(y.i4,{children:(0,t.jsx)(y.ki,{placeholder:"Select floor"})})}),(0,t.jsx)(y.Bw,{children:null==I?void 0:I.map(e=>(0,t.jsx)(y.Ql,{value:e.value.toString(),children:e.label},e.value))})]}),(0,t.jsx)(v.pf,{className:"text-base",children:"Select the issue Floor"}),(0,t.jsx)(v.zG,{className:"text-base"})]})}})]}),(0,t.jsx)(v.Wi,{control:o.control,name:"locationId",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.xJ,{children:[(0,t.jsx)(v.lX,{className:"text-base",children:"Location"}),(0,t.jsxs)(y.Ph,{onValueChange:s.onChange,value:s.value,children:[(0,t.jsx)(v.NI,{children:(0,t.jsx)(y.i4,{children:(0,t.jsx)(y.ki,{placeholder:"Select location"})})}),(0,t.jsx)(y.Bw,{children:null==d?void 0:d.map(e=>(0,t.jsx)(y.Ql,{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)(v.pf,{className:"text-base",children:"Select the issue location"}),(0,t.jsx)(v.zG,{className:"text-base"})]})}}),(0,t.jsx)(v.Wi,{control:o.control,name:"priority",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.xJ,{children:[(0,t.jsx)(v.lX,{className:"text-base",children:"Priority"}),(0,t.jsxs)(y.Ph,{onValueChange:s.onChange,value:s.value,children:[(0,t.jsx)(v.NI,{children:(0,t.jsx)(y.i4,{children:(0,t.jsx)(y.ki,{placeholder:"Select priority"})})}),(0,t.jsxs)(y.Bw,{children:[(0,t.jsx)(y.Ql,{value:"low",children:"Low"}),(0,t.jsx)(y.Ql,{value:"medium",children:"Medium"}),(0,t.jsx)(y.Ql,{value:"high",children:"High"})]})]}),(0,t.jsx)(v.pf,{className:"text-base",children:"Select the issue priority"}),(0,t.jsx)(v.zG,{className:"text-base"})]})}})]}),(0,t.jsx)(v.Wi,{control:o.control,name:"title",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.xJ,{children:[(0,t.jsx)(v.lX,{className:"text-base",children:"Issue Title"}),(0,t.jsx)(v.NI,{children:(0,t.jsx)(w.I,{...s})}),(0,t.jsx)(v.pf,{className:"text-base",children:"Provide a brief summary of the issue"}),(0,t.jsx)(v.zG,{className:"text-base"})]})}}),(0,t.jsx)(v.Wi,{control:o.control,name:"description",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.xJ,{children:[(0,t.jsx)(v.lX,{className:"text-base",children:"Description"}),(0,t.jsx)(v.NI,{children:(0,t.jsx)(b.g,{placeholder:"Enter issue description",className:"resize-none text-base",...s})}),(0,t.jsx)(v.pf,{className:"text-base",children:"Provide a detailed description of the issue"}),(0,t.jsx)(v.zG,{className:"text-base"})]})}}),(0,t.jsx)(v.Wi,{control:o.control,name:"tags",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.xJ,{children:[(0,t.jsx)(v.lX,{className:"text-base",children:"Issue Tags"}),(0,t.jsx)(v.NI,{children:(0,t.jsx)(A,{options:null!=g?g:[],initialSelected:s.value,onChange:s.onChange,name:s.name,placeholder:"Select tags..."})}),(0,t.jsx)(v.pf,{className:"text-base",children:"Add relevant issue categorey tags to help with reporting & allocation"}),(0,t.jsx)(v.zG,{className:"text-base"})]})}}),(0,t.jsx)("div",{className:"flex w-full",children:(0,t.jsx)(D.d,{name:"files",label:"Issue Images (Max 5)",multiple:!0,maxFiles:5})}),(0,t.jsxs)(f.z,{type:"submit",disabled:z,children:[z?(0,t.jsx)(j.Z,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Save Issue"]})]})})},U=l(5441),W=l(9413),V=l(2755);function E(e){let{items:s}=e,l=(0,a.useMemo)(()=>Object.fromEntries(Array.from(new Set(s.map(e=>e.type))).map((e,s)=>{var l,t;return[e,null!==(t=null===(l=V.Ly[s%V.Ly.length])||void 0===l?void 0:l.hex)&&void 0!==t?t:"#000000"]})),[s]);return(0,t.jsx)("div",{className:"relative flex flex-col gap-4 p-4",children:s.map((e,a)=>(0,t.jsxs)("div",{className:"relative flex w-full flex-row gap-4",children:[a!==s.length-1&&(0,t.jsx)("div",{className:"absolute left-5 top-12 h-full w-px bg-muted"}),(0,t.jsx)("div",{className:"relative z-10 flex h-full flex-col items-center",children:(0,t.jsx)(W.qE,{style:{borderColor:l[e.type],borderWidth:"2px"},children:(0,t.jsx)(W.Q5,{children:" + "})})}),(0,t.jsxs)("div",{className:"flex w-full flex-col",children:[(0,t.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("p",{className:"text-md font-semibold",children:[e.title,0===a&&(0,t.jsx)(o.C,{size:"xs",className:"ml-2",children:"Latest"})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(e._creationTime).toLocaleString()})]}),(0,t.jsx)(o.C,{className:"flex flex-row gap-1",size:"xs",style:{backgroundColor:"".concat(l[e.type],"20"),border:"0.5px solid ".concat(l[e.type]),color:l[e.type]},children:e.type})]}),(0,t.jsx)("p",{className:"text-sm text-foreground",children:e.description})]})]},e._id))})}var P=l(9644);function F(e){let{issue:s,onClose:l}=e,a="high"===s.priority.toLowerCase()?"red":"medium"===s.priority.toLowerCase()?"orange":"green";return(0,t.jsxs)("div",{className:"flex flex-col gap-4 w-full",children:[(0,t.jsxs)(x.Zb,{className:"w-full",children:[(0,t.jsxs)(x.Ol,{children:[(0,t.jsx)(x.ll,{className:"text-md",children:s.title}),(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,t.jsx)(o.C,{size:"xs",children:s.issueType.charAt(0).toUpperCase()+s.issueType.slice(1)}),(0,t.jsx)(o.C,{size:"xs",color:a,children:s.priority.charAt(0).toUpperCase()+s.priority.slice(1)}),(0,t.jsx)(o.C,{size:"xs",children:s.status})]})]}),(0,t.jsxs)(x.aY,{children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["Logged: ",(0,d.WU)(new Date(s._creationTime),"MMM d, yyyy HH:mm")]}),(0,t.jsx)("h3",{className:"text-md font-semibold mb-2",children:"Description"}),(0,t.jsx)("p",{className:"text-sm",children:s.description}),s.locationId&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h3",{className:"text-md font-semibold mb-2",children:"Location"}),(0,t.jsx)("p",{className:"text-sm",children:s.locationName})]}),s.files&&s.files.length>0&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h3",{className:"text-md font-semibold mb-2",children:"Attachments"}),(0,t.jsx)(U.Z,{images:s.files.map(e=>e.url)})]})]}),(0,t.jsx)(x.eW,{children:(0,t.jsx)(f.z,{onClick:l,variant:"outline",className:"w-full",children:"Back to Issues"})})]}),s.assignedToId&&(0,t.jsx)(B,{userId:s.assignedToId}),(0,t.jsx)(Q,{issueId:s._id})]})}function B(e){let{userId:s}=e,l=(0,c.aM)(n.h.allUsers.getUserById,{userId:s});return l?(0,t.jsxs)(x.Zb,{className:"w-full mt-4",children:[(0,t.jsx)(x.Ol,{children:(0,t.jsx)(x.ll,{className:"text-md",children:"Assigned User"})}),(0,t.jsx)(x.aY,{children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(W.qE,{children:[(0,t.jsx)(W.F$,{src:"https://api.dicebear.com/6.x/initials/svg?seed=".concat(l.firstname,"%20").concat(l.lastname)}),(0,t.jsxs)(W.Q5,{children:[l.firstname[0],l.lastname[0]]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-semibold",children:[l.firstname," ",l.lastname]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:l.email})]})]})}),(0,t.jsx)(x.eW,{children:(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[l.firstname," is making sure this issue gets resolved. We'll notify you with updates."]})})]}):(0,t.jsx)("p",{children:"Loading assigned user details ..."})}function Q(e){let{issueId:s}=e,l=(0,c.aM)(n.h.activity.getEntityActivity,{entityId:s,isUserActivity:!0});return void 0===l||l.length<1?(0,t.jsxs)(x.Zb,{children:[(0,t.jsx)(x.Ol,{className:"flex flex-row items-center justify-between",children:(0,t.jsx)(x.ll,{className:"text-md font-medium",children:"Activity"})}),(0,t.jsx)(x.aY,{className:"flex flex-col gap-4",children:(0,t.jsx)(P.Z,{badgeText:"No activity found",title:"No activity recorded",description:"No activity has been recorded for this space."})})]}):(0,t.jsxs)(x.Zb,{children:[(0,t.jsx)(x.Ol,{children:(0,t.jsx)(x.ll,{className:"text-md font-medium",children:"Activity"})}),(0,t.jsx)(x.aY,{className:"p-0",children:(0,t.jsx)(E,{items:l})})]})}var G=l(6638);function J(e){let{issueId:s,onSelectWorkOrder:l}=e,a=(0,c.aM)(n.h.workOrders.getWorkOrdersByTicketId,{ticketId:s});return void 0===a?(0,t.jsx)("div",{className:"flex justify-center items-center h-full text-primary",children:(0,t.jsx)(j.Z,{className:"w-8 h-8 animate-spin"})}):0===a.length?(0,t.jsx)("div",{className:"flex flex-col gap-4 pt-20",children:(0,t.jsx)(P.Z,{badgeText:"No Work Orders",title:"No Work Orders",description:"No work orders created for this issue."})}):(0,t.jsx)("div",{className:"flex flex-col gap-4",children:a.map(e=>(0,t.jsx)(X,{workOrder:e,onSelect:()=>l(e._id)},e._id))})}function X(e){var s,l,a,r,i,n;let{workOrder:c,onSelect:m}=e,u="high"===c.priority.toLowerCase()?"red":"medium"===c.priority.toLowerCase()?"orange":"green";return(0,t.jsxs)(x.Zb,{className:"w-full shadow-none transition-shadow duration-300 hover:border-muted hover:shadow-md hover:shadow-muted cursor-pointer",onClick:m,children:[(0,t.jsx)(x.Ol,{className:"flex flex-row items-center justify-between pb-2",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:(0,d.WU)(new Date(c._creationTime),"dd/MM/yyyy hh:mm a")}),(0,t.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,t.jsx)(o.C,{color:"completed"===c.status?"green":"blue",children:c.status}),(0,t.jsx)(o.C,{color:u,children:c.priority.toUpperCase()})]})]})}),(0,t.jsxs)(x.aY,{children:[(0,t.jsx)("h4",{className:"mb-2 font-medium",children:c.title}),(0,t.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Assigned Contractor: "}),(0,t.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,t.jsx)(W.qE,{className:"h-5 w-5",children:(0,t.jsx)(W.Q5,{className:"bg-muted-foreground text-[8px]",children:null!==(r=null===(s=c.contractorFirstName)||void 0===s?void 0:s.charAt(0))&&void 0!==r?r:"N"+(null!==(a=null===(l=c.contractorLastName)||void 0===l?void 0:l.charAt(0))&&void 0!==a?a:"A")})}),(0,t.jsx)("p",{className:"text-sm text-foreground",children:"".concat(null!==(i=c.contractorFirstName)&&void 0!==i?i:""," ").concat(null!==(n=c.contractorLastName)&&void 0!==n?n:""," ").concat(c.contractorCompany?"- ".concat(c.contractorCompany):"")})]})]})]})]})}var q=l(4122);function H(e){let{workOrderId:s,onClose:l}=e,a=(0,c.aM)(n.h.workOrders.getWorkOrderById,{id:s});if(!a)return(0,t.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,t.jsx)(j.Z,{className:"w-8 h-8 animate-spin"})});console.log("workOrder",a);let r="high"===a.priority.toLowerCase()?"red":"medium"===a.priority.toLowerCase()?"orange":"green";return(0,t.jsxs)("div",{className:"flex flex-col gap-4 w-full",children:[(0,t.jsxs)(x.Zb,{className:"w-full",children:[(0,t.jsxs)(x.Ol,{children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,t.jsx)(x.ll,{className:"text-md",children:a.title}),(0,t.jsx)(o.C,{icon:"resolved"===a.status.toLowerCase()?q.Z:void 0,color:"resolved"===a.status.toLowerCase()?"green":"pending"===a.status.toLowerCase()?"orange":"gray",size:"xs",children:a.status})]}),(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,t.jsxs)(o.C,{size:"xs",children:[a.workOrderType.charAt(0).toUpperCase()+a.workOrderType.slice(1)," ","Work Order"]}),(0,t.jsx)(o.C,{size:"xs",color:r,children:a.priority.charAt(0).toUpperCase()+a.priority.slice(1)})]})]}),(0,t.jsxs)(x.aY,{children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["Logged:"," ",(0,d.WU)(new Date(a._creationTime),"MMM d, yyyy HH:mm")]}),(0,t.jsx)("h3",{className:"text-md font-semibold mb-2",children:"Description"}),(0,t.jsx)("p",{className:"text-sm",children:a.description}),a.tags&&a.tags.length>0&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h3",{className:"text-md font-semibold mb-2",children:"Tags"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:a.tags.map((e,s)=>(0,t.jsx)(o.C,{size:"xs",children:e.label},s))})]}),a.images&&a.images.length>0&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h3",{className:"text-md font-semibold mb-2",children:"Attachments"}),(0,t.jsx)(U.Z,{images:a.images})]})]}),(0,t.jsx)(x.eW,{children:(0,t.jsx)(f.z,{onClick:l,variant:"outline",className:"w-full",children:"Back to Work Orders"})})]}),a.assignedContractor&&(0,t.jsx)($,{assignedContractor:a.assignedContractor})]})}function $(e){let{assignedContractor:s}=e;return s?(0,t.jsxs)(x.Zb,{className:"w-full mt-4",children:[(0,t.jsx)(x.Ol,{children:(0,t.jsx)(x.ll,{className:"text-md",children:"Assigned Contractor"})}),(0,t.jsx)(x.aY,{children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(W.qE,{children:[(0,t.jsx)(W.F$,{src:"https://api.dicebear.com/6.x/initials/svg?seed=".concat(s.name)}),(0,t.jsx)(W.Q5,{children:s.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:s.name}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:s.businessName}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:s.email})]})]})}),(0,t.jsx)(x.eW,{children:(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[s.name," will arrange a time to resolve this issue."]})})]}):(0,t.jsxs)(x.Zb,{className:"w-full mt-4",children:[(0,t.jsx)(x.Ol,{children:(0,t.jsx)(x.ll,{className:"text-md",children:"Assigned Contractor"})}),(0,t.jsx)(x.aY,{children:(0,t.jsx)(o.C,{color:"gray",children:"No contractor assigned yet"})})]})}function K(){let e=(0,c.aM)(n.h.tickets.getAllOccupantIssues),s=null==e?void 0:e.filter(e=>"Resolved"===e.status||"Closed"===e.status),l=null==e?void 0:e.filter(e=>"Resolved"!==e.status&&"Closed"!==e.status),{openDrawer:d}=(0,u.Z)(),[x,h]=(0,a.useState)(null),[p,g]=(0,a.useState)(null),N=e=>{h(e),g(null)};return(0,t.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,t.jsx)("div",{className:"flex-grow overflow-auto",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4 items-start justify-start pt-16 p-4 pb-[120px] w-full",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between w-full",children:[(0,t.jsx)("div",{className:"flex flex-col gap-2",children:(0,t.jsxs)("div",{className:"flex flex-row items-center gap-4",children:[(0,t.jsx)("div",{className:"w-5 h-5 fill-foreground",children:(0,t.jsx)(i.BZ,{})}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:x?"Issue Details":"Maintenance Issues"}),!x&&(0,t.jsx)(o.C,{size:"xs",color:"purple",children:"".concat((null==l?void 0:l.length)||0," Open Issues")})]})]})}),(0,t.jsx)(f.z,{onClick:x?()=>{x&&d("Edit Issue","Edit the selected maintenance issue.",(0,t.jsx)(M,{selectedIssue:x}))}:()=>{d("Report Issue","Report a new maintenance issue for your space or facility.",(0,t.jsx)(M,{}))},children:x?"Edit Issue":"Report Issue"})]}),x?(0,t.jsx)("div",{className:"w-full",children:(0,t.jsxs)(G.mQ,{defaultValue:"details",className:"w-full",children:[(0,t.jsxs)(G.dr,{className:"w-full",children:[(0,t.jsx)(G.SP,{value:"details",className:"w-full",children:"Details"}),(0,t.jsx)(G.SP,{value:"workorders",className:"w-full",children:"Work Orders"})]}),(0,t.jsx)(G.nU,{value:"details",children:(0,t.jsx)(F,{issue:x,onClose:()=>h(null)})}),(0,t.jsx)(G.nU,{value:"workorders",children:p?(0,t.jsx)(H,{workOrderId:p,onClose:()=>g(null)}):(0,t.jsx)(J,{issueId:x._id,onSelectWorkOrder:e=>{g(e)}})})]})}):(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Open Issues"}),void 0===e?(0,t.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,t.jsx)(j.Z,{className:"h-8 w-8 animate-spin text-primary"})}):0===l.length?(0,t.jsx)(P.Z,{badgeText:"No open issues",title:"No open issues",description:"You don't have any open maintenance issues at the moment."}):(0,t.jsx)("div",{className:"flex flex-col gap-2",children:l.map(e=>(0,t.jsx)(m,{issue:e,onSelect:()=>N(e)},e._id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex flex-row items-center gap-4 mb-4",children:[(0,t.jsx)(q.Z,{className:"w-5 h-5"}),(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Resolved Issues"})]}),void 0===e?(0,t.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,t.jsx)(j.Z,{className:"h-8 w-8 animate-spin text-primary"})}):0===s.length?(0,t.jsx)(P.Z,{badgeText:"No resolved issues",title:"No resolved issues",description:"You don't have any resolved maintenance issues."}):(0,t.jsx)("div",{className:"flex flex-col gap-2",children:s.map(e=>(0,t.jsx)(m,{issue:e,onSelect:()=>N(e)},e._id))})]})]})]})}),(0,t.jsx)(r.Z,{})]})}},9413:function(e,s,l){"use strict";l.d(s,{F$:function(){return c},Q5:function(){return o},qE:function(){return n}});var t=l(909),a=l(151),r=l(2419),i=l(9061);let n=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(r.fC,{ref:s,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",l),...a})});n.displayName=r.fC.displayName;let c=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(r.Ee,{ref:s,className:(0,i.cn)("aspect-square h-full w-full",l),...a})});c.displayName=r.Ee.displayName;let o=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(r.NY,{ref:s,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",l),...a})});o.displayName=r.NY.displayName},242:function(e,s,l){"use strict";l.d(s,{Bw:function(){return h},Ph:function(){return d},Ql:function(){return p},i4:function(){return m},ki:function(){return x}});var t=l(909),a=l(151),r=l(6259),i=l(9855),n=l(4736),c=l(6849),o=l(9061);let d=r.fC;r.ZA;let x=r.B4,m=a.forwardRef((e,s)=>{let{className:l,children:a,...n}=e;return(0,t.jsxs)(r.xz,{ref:s,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",l),...n,children:[a,(0,t.jsx)(r.JO,{asChild:!0,children:(0,t.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=r.xz.displayName;let u=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(r.u_,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",l),...a,children:(0,t.jsx)(n.Z,{className:"h-4 w-4"})})});u.displayName=r.u_.displayName;let f=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(r.$G,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",l),...a,children:(0,t.jsx)(i.Z,{className:"h-4 w-4"})})});f.displayName=r.$G.displayName;let h=a.forwardRef((e,s)=>{let{className:l,children:a,position:i="popper",...n}=e;return(0,t.jsx)(r.h_,{children:(0,t.jsxs)(r.VY,{ref:s,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",l),position:i,...n,children:[(0,t.jsx)(u,{}),(0,t.jsx)(r.l_,{className:(0,o.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,t.jsx)(f,{})]})})});h.displayName=r.VY.displayName,a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(r.__,{ref:s,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",l),...a})}).displayName=r.__.displayName;let p=a.forwardRef((e,s)=>{let{className:l,children:a,...i}=e;return(0,t.jsxs)(r.ck,{ref:s,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l),...i,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(r.wU,{children:(0,t.jsx)(c.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(r.eT,{children:a})]})});p.displayName=r.ck.displayName,a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(r.Z0,{ref:s,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",l),...a})}).displayName=r.Z0.displayName},6638:function(e,s,l){"use strict";l.d(s,{SP:function(){return o},dr:function(){return c},mQ:function(){return n},nU:function(){return d}});var t=l(909),a=l(151),r=l(3624),i=l(9061);let n=r.fC,c=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(r.aV,{ref:s,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",l),...a})});c.displayName=r.aV.displayName;let o=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(r.xz,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-primary data-[state=active]:text-white data-[state=active]:shadow-sm",l),...a})});o.displayName=r.xz.displayName;let d=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(r.VY,{ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",l),...a})});d.displayName=r.VY.displayName}},function(e){e.O(0,[7537,3230,7400,3050,9811,1532,6556,2948,8521,7307,5066,3624,9548,1029,4181,4928,329,6251,2663,1744],function(){return e(e.s=7495)}),_N_E=e.O()}]);